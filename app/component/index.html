<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>Web Component Editor - Kyte Shipyard</title>
    <!-- Stylesheets -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css">
    <link href="https://cdn.jsdelivr.net/npm/vscode-codicons@0.0.17/dist/codicon.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.23/css/jquery.dataTables.min.css">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.13.0/themes/base/jquery-ui.css">
    <!--  -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&family=Nunito:wght@200;500;700&display=swap" rel="stylesheet">
    <!-- javascripts -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <script src="https://cdn.datatables.net/1.10.23/js/jquery.dataTables.min.js"></script>
    <script src="https://code.jquery.com/ui/1.13.0/jquery-ui.min.js" integrity="sha256-hlKLmzaRlE8SCJC1Kw8zoUbU8BxA+8kR3gseuKfMjxA=" crossorigin="anonymous"></script>
    <!-- html2canvas for snapshot feature -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <!-- Kyte -->
    <script>
        // Auto-detect localhost and conditionally load local kyte.js for development
        (function() {
            const isLocalhost = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';

            // Load kyte.js: use local dev version on localhost, otherwise use CDN
            const kyteScript = isLocalhost ? '/assets/js/kyte-dev.js' : 'https://cdn.keyqcloud.com/kyte/js/stable/kyte.js';
            document.write('<script src="' + kyteScript + '"' + (isLocalhost ? '' : ' crossorigin="anonymous"') + '><\/script>');

            if (isLocalhost) {
                console.log('%c[DEV MODE] Loading local kyte-api-js from /assets/js/kyte-dev.js', 'color: #FF6B6B; font-weight: bold;');
            }
        })();
    </script>
    <script>
        // Auto-detect localhost and load non-obfuscated source files for development
        (function() {
            const isLocalhost = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';
            const jsPath = isLocalhost ? '/assets/js/source/' : '/assets/js/';

            const scripts = [
                'kyte-i18n.js',
                'kyte-shipyard.js',
                'navigation.js',
                'kyte-shipyard-tables.js'
            ];

            scripts.forEach(function(script) {
                document.write('<script src="' + jsPath + script + '"><\/script>');
            });

            // Load component details script (not a module anymore - uses AMD loader)
            const componentDetailsPath = isLocalhost
                ? '/assets/js/source/kyte-shipyard-component-details.js'
                : '/assets/js/kyte-shipyard-component-details.js';
            document.write('<script src="' + componentDetailsPath + '"><\/script>');

            if (isLocalhost) {
                console.log('%c[DEV MODE] Loading non-obfuscated source files from ' + jsPath, 'color: #4CAF50; font-weight: bold;');
            }
        })();
    </script>

    <!-- Monaco Editor Loader -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.45.0/min/vs/loader.min.js"></script>
    <script>
        // Configure Monaco Editor loader
        require.config({
            paths: {
                'vs': 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.45.0/min/vs'
            }
        });
    </script>

    <style>
        /* Fix Monaco Editor codicon font */
        @font-face {
            font-family: "codicon";
            font-display: block;
            src: url("https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.45.0/min/vs/base/browser/ui/codicons/codicon/codicon.ttf") format("truetype");
        }

        /* Override any Monaco styles that might be looking for local codicon font */
        .monaco-editor .codicon,
        .monaco-workbench .codicon,
        .codicon[class*='codicon-'] {
            font-family: "codicon" !important;
        }

        * {
            box-sizing: border-box;
        }

        body, html {
            height: 100%;
            margin: 0;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #1e1e1e;
            color: #d4d4d4;
            overflow: hidden;
        }

        /* Main Layout Structure */
        #wrapper {
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        main {
            height: 100% !important;
            flex-direction: row !important;
            display: flex !important;
            flex-wrap: nowrap !important;
            overflow-x: auto !important;
            overflow-y: hidden !important;
            flex: 1;
        }

        /* Modern Sidebar */
        #sidenav {
            width: 280px;
            background: #252526;
            border-right: 1px solid #3e3e42;
            color: #cccccc;
            display: flex;
            flex-direction: column;
            min-height: 100%;
            overflow-y: auto;
            z-index: 1010;
        }

        .sidebar-header {
            padding: 1.5rem;
            border-bottom: 1px solid #3e3e42;
            background: #2d2d30;
        }

        .sidebar-nav {
            padding: 1rem 0;
            flex: 1;
        }

        .nav-section {
            margin-bottom: 1.5rem;
        }

        .nav-section-title {
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #969696;
            padding: 0 1.5rem;
            margin-bottom: 0.5rem;
        }

        .nav-link {
            display: flex !important;
            align-items: center !important;
            padding: 0.75rem 1.5rem !important;
            color: #cccccc !important;
            text-decoration: none !important;
            transition: all 0.2s ease !important;
            font-weight: 400 !important;
            border: none !important;
            background: none !important;
            width: 100%;
            text-align: left;
            border-radius: 0 !important;
            margin: 0 !important;
            font-size: 0.9rem;
        }

        .nav-link:hover {
            background: #2a2d2e !important;
            color: #ffffff !important;
        }

        .nav-link.active {
            background: #37373d !important;
            color: #ffffff !important;
            border-right: 2px solid #ff6b35 !important;
            font-weight: 500 !important;
        }

        .nav-link i {
            width: 16px !important;
            margin-right: 12px !important;
            font-size: 0.9rem !important;
        }

        /* Editor Layout */
        .editor-box {
            display: flex;
            flex-flow: column;
            height: 100%;
            flex: 1;
            background: #1e1e1e;
        }

        .editor-box-header {
            flex: 0 1 auto;
            background: #2d2d30;
            border-bottom: 1px solid #3e3e42;
        }

        .editor-box-content {
            flex: 1 1 auto;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        /* Header Controls */
        .editor-header-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 1.5rem;
        }

        .component-info {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
        }

        .component-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #ffffff;
            margin: 0;
        }

        .component-identifier {
            font-size: 0.85rem;
            color: #969696;
            margin: 0;
            font-family: 'JetBrains Mono', monospace;
        }

        /* Enhanced Buttons */
        .btn-editor {
            font-size: 0.85rem;
            font-weight: 500;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            border: 1px solid transparent;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-editor-danger {
            background: #f85149;
            color: white;
            border-color: #f85149;
        }

        .btn-editor-danger:hover {
            background: #da3633;
            color: white;
        }

        .btn-editor-warning {
            background: #fb8500;
            color: white;
            border-color: #fb8500;
        }

        .btn-editor-warning:hover {
            background: #e76f00;
            color: white;
        }

        .btn-editor-success {
            background: #238636;
            color: white;
            border-color: #238636;
        }

        .btn-editor-success:hover {
            background: #2ea043;
            color: white;
        }

        /* Tab Navigation */
        .editor-tabs {
            display: flex;
            background: #252526;
            border-bottom: 1px solid #3e3e42;
            overflow-x: auto;
        }

        .editor-tab {
            padding: 0.75rem 1.5rem;
            background: transparent;
            border: none;
            color: #969696;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            border-bottom: 2px solid transparent;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .editor-tab:hover {
            background: #2a2d2e;
            color: #cccccc;
        }

        .editor-tab.active {
            background: #1e1e1e;
            color: #ffffff;
            border-bottom-color: #ff6b35;
        }

        .editor-tab i {
            font-size: 0.8rem;
        }

        /* Grid Layout for Editors */
        .editor-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
            gap: 1px;
            height: 100%;
            background: #3e3e42;
        }

        .editor-panel {
            background: #1e1e1e;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .panel-header {
            background: #2d2d30;
            color: #ffffff;
            padding: 0.75rem 1rem;
            font-size: 0.85rem;
            font-weight: 600;
            border-bottom: 1px solid #3e3e42;
        }

        .panel-content {
            flex: 1;
            position: relative;
        }

        /* Monaco Editor Containers */
        .monaco-container {
            width: 100%;
            height: 100%;
        }

        /* Preview Container */
        .preview-container {
            width: 100%;
            height: 100%;
            background: #ffffff;
        }

        .preview-container iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        /* Properties Panel */
        .properties-container {
            width: 100%;
            height: 100%;
            overflow-y: auto;
            padding: 1rem;
        }

        .properties-section {
            margin-bottom: 1.5rem;
        }

        .properties-section h6 {
            color: #ffffff;
            font-weight: 600;
            margin-bottom: 0.75rem;
            font-size: 0.9rem;
        }

        .placeholder-item {
            margin-bottom: 0.75rem;
        }

        .placeholder-item label {
            display: block;
            color: #cccccc;
            font-size: 0.85rem;
            margin-bottom: 0.25rem;
            font-family: 'JetBrains Mono', monospace;
        }

        .placeholder-item input {
            width: 100%;
            background: #3c3c3c;
            border: 1px solid #5a5a5a;
            color: #d4d4d4;
            border-radius: 4px;
            padding: 0.5rem;
            font-size: 0.85rem;
            transition: all 0.2s ease;
        }

        .placeholder-item input:focus {
            background: #404040;
            border-color: #ff6b35;
            box-shadow: 0 0 0 2px rgba(255, 107, 53, 0.2);
            color: #ffffff;
            outline: none;
        }

        /* Footer */
        footer {
            background: #252526;
            border-top: 1px solid #3e3e42;
            flex-shrink: 0;
        }

        .footer-content {
            font-size: 0.75rem;
            color: #969696;
            padding: 0.75rem 1.25rem;
        }

        /* Loading Modal */
        .modal.white {
            background: rgba(30, 30, 30, 0.95);
            backdrop-filter: blur(10px);
        }

        .spinner-wrapper {
            color: #ff6b35;
        }

        /* Mobile Sidebar Toggle */
        .sidebar-toggle {
            display: none;
            position: fixed;
            top: 1rem;
            left: 1rem;
            z-index: 1060;
            background: #2d2d30;
            border: 1px solid #3e3e42;
            color: #cccccc;
            padding: 0.5rem;
            border-radius: 4px;
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            #sidenav {
                width: 250px;
            }
            
            .editor-grid {
                grid-template-columns: 1fr;
                grid-template-rows: auto auto auto auto;
            }
        }

        @media (max-width: 768px) {
            .sidebar-toggle {
                display: block;
            }

            #sidenav {
                position: absolute;
                z-index: 1050;
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }
            
            #sidenav.show {
                transform: translateX(0);
            }
            
            .editor-header-controls {
                padding: 0.75rem;
                flex-direction: column;
                gap: 1rem;
                align-items: stretch;
            }
            
            .component-info {
                align-items: flex-start;
            }
            
            .editor-tabs {
                overflow-x: auto;
                flex-wrap: nowrap;
            }
            
            .btn-editor {
                font-size: 0.8rem;
                padding: 0.4rem 0.8rem;
            }

            .editor-grid {
                grid-template-columns: 1fr;
                grid-template-rows: auto auto auto auto;
            }
        }

        /* Accessibility */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        /* Editor containers */
        .editor-container {
            display: none;
        }

        .editor-container.active {
            display: block;
            height: 100%;
        }

        /* Secondary content areas */
        .secondary-content {
            padding: 2rem;
            background: #1e1e1e;
            color: #d4d4d4;
            height: 100%;
            overflow-y: auto;
            display: none;
        }

        .secondary-content.active {
            display: block;
        }

        .secondary-content h4 {
            color: #ffffff;
            font-weight: 600;
            margin-bottom: 1rem;
        }

        /* Settings Cards */
        .settings-grid {
            display: grid;
            gap: 1.5rem;
        }

        .setting-card {
            background: #252526;
            border: 1px solid #3e3e42;
            border-radius: 8px;
            overflow: hidden;
        }

        .setting-card-header {
            background: #2d2d30;
            padding: 1rem 1.25rem;
            border-bottom: 1px solid #3e3e42;
            font-weight: 600;
            color: #ffffff;
            font-size: 0.9rem;
        }

        .setting-card-body {
            padding: 1.25rem;
        }

        .form-control, .form-select {
            background: #3c3c3c;
            border: 1px solid #5a5a5a;
            color: #d4d4d4;
            border-radius: 4px;
            padding: 0.75rem;
            font-size: 0.9rem;
            transition: all 0.2s ease;
        }

        .form-control:focus, .form-select:focus {
            background: #404040;
            border-color: #ff6b35;
            box-shadow: 0 0 0 2px rgba(255, 107, 53, 0.2);
            color: #ffffff;
            outline: none;
        }

        .form-control::placeholder {
            color: #969696;
        }

        textarea.form-control {
            min-height: 80px;
            resize: vertical;
        }

        /* Preview Mode Buttons */
        .preview-mode-btn {
            background: #3c3c3c !important;
            border: 1px solid #5a5a5a !important;
            color: #d4d4d4 !important;
            padding: 0.25rem 0.5rem;
            transition: all 0.2s ease;
        }

        .preview-mode-btn:hover {
            background: #4a4a4a !important;
            color: #ffffff !important;
        }

        .preview-mode-btn.active {
            background: #ff6b35 !important;
            border-color: #ff6b35 !important;
            color: #ffffff !important;
        }

        /* Quick Test Preview Grid */
        .quick-test-preview {
            display: grid;
            gap: 1rem;
            grid-template-columns: 1fr;
            padding: 1rem;
            background: #252526;
            border: 1px solid #3e3e42;
            border-radius: 8px;
            min-height: 400px;
        }

        .quick-test-preview.instances-2 {
            grid-template-columns: 1fr 1fr;
        }

        .quick-test-preview.instances-3 {
            grid-template-columns: 1fr 1fr 1fr;
        }

        .quick-test-item {
            background: #ffffff;
            padding: 1rem;
            border-radius: 4px;
            border: 1px solid #ddd;
        }

        /* Quick Test Mode Buttons */
        .quick-test-mode-btn {
            background: #3c3c3c;
            border: 1px solid #5a5a5a;
            color: #d4d4d4;
        }

        .quick-test-mode-btn:hover {
            background: #4a4a4a;
            color: #ffffff;
        }

        .quick-test-mode-btn.active {
            background: #ff6b35;
            border-color: #ff6b35;
            color: #ffffff;
        }

        /* Preview Container Responsive Width */
        .preview-container iframe {
            max-width: 100%;
            margin: 0 auto;
            display: block;
            transition: width 0.3s ease;
        }

        /* Modal Tab Styling */
        .nav-tabs .nav-link {
            background: #252526;
            border: 1px solid #3e3e42;
            color: #d4d4d4;
        }

        .nav-tabs .nav-link:hover {
            background: #2d2d30;
            color: #ffffff;
        }

        .nav-tabs .nav-link.active {
            background: #ff6b35;
            border-color: #ff6b35;
            color: #ffffff;
        }

        /* Sample Data Editor Container */
        .sample-data-editor {
            position: relative;
        }

        .sample-data-editor #sampleDataEditor {
            width: 100%;
            height: 100%;
        }

        /* Properties Panel Type Icons */
        .property-type-icon {
            color: #969696;
            font-size: 0.8rem;
            margin-left: 0.5rem;
        }

        /* Enhanced placeholder item with type selector */
        .placeholder-item .input-group {
            display: flex;
            gap: 0.5rem;
        }

        .placeholder-item select.form-select {
            max-width: 150px;
            font-size: 0.85rem;
        }
    </style>
</head>

<body>
    <!-- Mobile Sidebar Toggle -->
    <button class="sidebar-toggle" id="sidebarToggle">
        <i class="fas fa-bars"></i>
    </button>

    <!-- Page loading modal -->
    <div id="pageLoaderModal" class="modal white" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1">
        <div class="modal-dialog modal-sm h-100 d-flex">
            <div class="mx-auto align-self-center" style="width: 48px">
                <div class="spinner-wrapper text-center fa-6x"><span class="fas fa-sync fa-spin"></span></div>
            </div>
        </div>
    </div>

    <div id="wrapper">
        <main class="editor">
            <!-- BEGIN SIDE NAVIGATION -->
            <!-- <div id="sidenav" class="d-flex flex-column flex-shrink-0">
                <div class="sidebar-header">
                    <div class="d-flex justify-content-between align-items-center">
                        <h6 class="mb-0 text-white">Component Editor</h6>
                        <button class="btn btn-sm text-white d-md-none" id="closeSidebar">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
                
                <div class="sidebar-nav">
                    <div class="nav-section">
                        <div class="nav-section-title">Editor</div>
                        <button class="nav-link active" data-target="Editor">
                            <i class="fas fa-code"></i>
                            Code Editor
                        </button>
                        <button class="nav-link" data-target="Settings">
                            <i class="fas fa-cog"></i>
                            Component Settings
                        </button>
                    </div>
                </div>
            </div> -->
            <!-- END SIDE NAVIGATION -->

            <div class="editor-box">
                <!-- Editor Header -->
                <div class="editor-box-header">
                    <div class="editor-header-controls">
                        <div>
                            <a class="btn-editor btn-editor-danger" id="backToController" href="#">
                                <i class="fas fa-arrow-left"></i>
                                <span data-i18n="ui.component_editor.exit">Exit</span>
                            </a>
                        </div>

                        <div class="component-info">
                            <h2 class="component-title" id="component-name">Component Name</h2>
                            <h3 class="component-identifier" id="component-identifier">component-identifier</h3>
                        </div>

                        <div class="d-flex gap-2">
                            <button class="btn-editor btn-editor-success" id="getCodeBtn">
                                <i class="fas fa-code"></i>
                                <span data-i18n="ui.component_editor.get_code">Get Code</span>
                            </button>
                            <button class="btn-editor btn-editor-info" id="snapshotBtn" data-i18n-title="ui.component_editor.snapshot.tooltip" title="Take preview snapshot for gallery view">
                                <i class="fas fa-camera"></i>
                                <span data-i18n="ui.component_editor.snapshot">Snapshot</span>
                            </button>
                            <button class="btn-editor btn-editor-success" id="exportBtn">
                                <i class="fas fa-download"></i>
                                <span data-i18n="ui.component_editor.export">Export</span>
                            </button>
                            <button class="btn-editor btn-editor-warning" id="saveCode">
                                <i class="fas fa-save"></i>
                                <span data-i18n="ui.component_editor.save">Save</span>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Editor Tabs -->
                    <div class="editor-tabs">
                        <button class="editor-tab active" data-target="Editor">
                            <i class="fas fa-code"></i>
                            <span data-i18n="ui.component_editor.tabs.code_editor">Code Editor</span>
                        </button>
                        <button class="editor-tab" data-target="SampleData">
                            <i class="fas fa-database"></i>
                            <span data-i18n="ui.component_editor.tabs.sample_data">Sample Data</span>
                        </button>
                        <button class="editor-tab" data-target="QuickTest">
                            <i class="fas fa-vial"></i>
                            <span data-i18n="ui.component_editor.tabs.quick_test">Quick Test</span>
                        </button>
                        <button class="editor-tab" data-target="Settings">
                            <i class="fas fa-cog"></i>
                            <span data-i18n="ui.component_editor.tabs.settings">Settings</span>
                        </button>
                        <button class="editor-tab" data-target="Help">
                            <i class="fas fa-question-circle"></i>
                            <span data-i18n="ui.component_editor.tabs.help">Help</span>
                        </button>
                    </div>
                </div>
                
                <!-- Editor Content -->
                <div class="editor-box-content">
                    <!-- Code Editor Grid -->
                    <div id="Editor" class="editor-container active">
                        <div class="editor-grid">
                            <!-- HTML Editor -->
                            <div class="editor-panel">
                                <div class="panel-header">
                                    <i class="fab fa-html5 me-2"></i>
                                    <span data-i18n="ui.component_editor.panels.html_template">HTML Template</span>
                                </div>
                                <div class="panel-content">
                                    <div id="htmlEditor" class="monaco-container"></div>
                                </div>
                            </div>

                            <!-- CSS Editor -->
                            <div class="editor-panel">
                                <div class="panel-header">
                                    <i class="fab fa-css3-alt me-2"></i>
                                    <span data-i18n="ui.component_editor.panels.css_styles">CSS Styles</span>
                                </div>
                                <div class="panel-content">
                                    <div id="cssEditor" class="monaco-container"></div>
                                </div>
                            </div>

                            <!-- Preview -->
                            <div class="editor-panel">
                                <div class="panel-header">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <i class="fas fa-eye me-2"></i>
                                            <span data-i18n="ui.component_editor.panels.live_preview">Live Preview</span>
                                        </div>
                                        <div class="btn-group btn-group-sm" role="group">
                                            <button type="button" class="btn btn-sm preview-mode-btn active" data-width="100%" data-i18n-title="ui.component_editor.preview.desktop" title="Desktop">
                                                <i class="fas fa-desktop"></i>
                                            </button>
                                            <button type="button" class="btn btn-sm preview-mode-btn" data-width="768px" data-i18n-title="ui.component_editor.preview.tablet" title="Tablet">
                                                <i class="fas fa-tablet-alt"></i>
                                            </button>
                                            <button type="button" class="btn btn-sm preview-mode-btn" data-width="375px" data-i18n-title="ui.component_editor.preview.mobile" title="Mobile">
                                                <i class="fas fa-mobile-alt"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div class="panel-content">
                                    <div id="preview" class="preview-container"></div>
                                </div>
                            </div>

                            <!-- Properties Panel -->
                            <div class="editor-panel">
                                <div class="panel-header">
                                    <i class="fas fa-sliders-h me-2"></i>
                                    <span data-i18n="ui.component_editor.panels.properties">Properties & Placeholders</span>
                                </div>
                                <div class="panel-content">
                                    <div class="properties-container">
                                        <div class="properties-section">
                                            <h6 data-i18n="ui.component_editor.panels.template_placeholders">Template Placeholders</h6>
                                            <div id="placeholderWrapper">
                                                <!-- Placeholder inputs will be generated here -->
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Settings Section -->
                    <div id="Settings" class="secondary-content">
                        <h4 class="mb-4" data-i18n="ui.component_editor.settings.title">Component Settings</h4>
                        <div class="settings-grid">
                            <!-- Component Name -->
                            <div class="setting-card">
                                <div class="setting-card-header" data-i18n="ui.component_editor.settings.component_name">Component Name</div>
                                <div class="setting-card-body">
                                    <input type="text" class="form-control" id="setting-component-name" data-i18n-placeholder="ui.component_editor.settings.placeholder.name" placeholder="Enter component name" />
                                </div>
                            </div>

                            <!-- Component Identifier -->
                            <div class="setting-card">
                                <div class="setting-card-header" data-i18n="ui.component_editor.settings.component_identifier">Component Identifier</div>
                                <div class="setting-card-body">
                                    <input type="text" class="form-control" id="setting-component-identifier" data-i18n-placeholder="ui.component_editor.settings.placeholder.identifier" placeholder="component-identifier" />
                                    <small class="text-muted mt-2 d-block" data-i18n="ui.component_editor.settings.identifier_help">Unique identifier for this component</small>
                                </div>
                            </div>

                            <!-- Description -->
                            <div class="setting-card">
                                <div class="setting-card-header" data-i18n="ui.component_editor.settings.description">Description</div>
                                <div class="setting-card-body">
                                    <textarea class="form-control" id="setting-component-description" data-i18n-placeholder="ui.component_editor.settings.placeholder.description" placeholder="Describe the purpose and usage of this component"></textarea>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Sample Data Section -->
                    <div id="SampleData" class="secondary-content">
                        <h4 class="mb-4" data-i18n="ui.component_editor.sample_data.title">Sample Data for Testing</h4>
                        <p class="text-muted mb-3" data-i18n="ui.component_editor.sample_data.description">Define sample data as a JSON array to test your component with realistic values. The preview will render multiple instances using this data.</p>
                        <div class="sample-data-editor" style="height: 500px; border: 1px solid #3e3e42; border-radius: 8px;">
                            <div id="sampleDataEditor"></div>
                        </div>
                        <div class="mt-3">
                            <button class="btn btn-sm btn-success" id="applySampleDataBtn">
                                <i class="fas fa-check"></i> <span data-i18n="ui.component_editor.sample_data.apply">Apply Sample Data to Preview</span>
                            </button>
                            <button class="btn btn-sm btn-secondary" id="clearSampleDataBtn">
                                <i class="fas fa-times"></i> <span data-i18n="ui.component_editor.sample_data.clear">Clear</span>
                            </button>
                        </div>
                    </div>

                    <!-- Quick Test Section -->
                    <div id="QuickTest" class="secondary-content">
                        <h4 class="mb-4" data-i18n="ui.component_editor.quick_test.title">Quick Test - Multiple Instances</h4>
                        <p class="text-muted mb-3" data-i18n="ui.component_editor.quick_test.description">See how your component looks with multiple instances side-by-side</p>
                        <div class="d-flex gap-2 mb-3">
                            <button class="btn btn-sm btn-primary quick-test-mode-btn active" data-instances="1" data-i18n="ui.component_editor.quick_test.single">Single</button>
                            <button class="btn btn-sm btn-primary quick-test-mode-btn" data-instances="2" data-i18n="ui.component_editor.quick_test.double">Double</button>
                            <button class="btn btn-sm btn-primary quick-test-mode-btn" data-instances="3" data-i18n="ui.component_editor.quick_test.triple">Triple</button>
                        </div>
                        <div id="quickTestPreview" class="quick-test-preview">
                            <!-- Multiple component instances will be rendered here -->
                        </div>
                    </div>

                    <!-- Help Section -->
                    <div id="Help" class="secondary-content">
                        <h4 class="mb-4" data-i18n="ui.component_editor.help.title">Web Component Help & Documentation</h4>

                        <div class="setting-card mb-3">
                            <div class="setting-card-header">
                                <i class="fas fa-info-circle me-2"></i>
                                <span data-i18n="ui.component_editor.help.what.title">What are Web Components?</span>
                            </div>
                            <div class="setting-card-body">
                                <p data-i18n="ui.component_editor.help.what.description">Web Components are reusable HTML+CSS templates that can be dynamically populated with data. They use mustache-style placeholders for dynamic content.</p>
                            </div>
                        </div>

                        <div class="setting-card mb-3">
                            <div class="setting-card-header">
                                <i class="fas fa-code me-2"></i>
                                <span data-i18n="ui.component_editor.help.syntax.title">Placeholder Syntax</span>
                            </div>
                            <div class="setting-card-body">
                                <p data-i18n="ui.component_editor.help.syntax.description">Use double curly braces to create placeholders in your HTML:</p>
                                <pre style="background: #1e1e1e; padding: 1rem; border-radius: 4px; color: #d4d4d4;"><code>&lt;h3&gt;<span style="color: #ff6b35;">{{title}}</span>&lt;/h3&gt;
&lt;p&gt;<span style="color: #ff6b35;">{{description}}</span>&lt;/p&gt;
&lt;img src="<span style="color: #ff6b35;">{{image_url}}</span>" /&gt;</code></pre>
                            </div>
                        </div>

                        <div class="setting-card mb-3">
                            <div class="setting-card-header">
                                <i class="fas fa-laptop-code me-2"></i>
                                <span data-i18n="ui.component_editor.help.usage.title">Using in Your Application</span>
                            </div>
                            <div class="setting-card-body">
                                <p data-i18n="ui.component_editor.help.usage.description">Load and use your component with kyte-api-js:</p>
                                <pre style="background: #1e1e1e; padding: 1rem; border-radius: 4px; color: #d4d4d4; font-size: 0.85rem;"><code>// Load component from API
_kyte.get('KyteWebComponent', 'identifier', 'my-component', [], (r) => {
    let component = r.data[0];
    let components = {};
    components[component.identifier] =
        component.html + '&lt;style&gt;' + component.stylesheet + '&lt;/style&gt;';

    // Create instance and bind data
    let kwc = new KyteWebComponent(components);
    kwc.bind('#container', component.identifier, yourDataArray);
});</code></pre>
                                <p class="mt-2"><small data-i18n="ui.component_editor.help.usage.note" data-i18n-html="true">Use the <strong>"Get Code"</strong> button for component-specific code you can copy.</small></p>
                            </div>
                        </div>

                        <div class="setting-card mb-3">
                            <div class="setting-card-header">
                                <i class="fas fa-paint-brush me-2"></i>
                                <span data-i18n="ui.component_editor.help.css.title">CSS Scoping Tips</span>
                            </div>
                            <div class="setting-card-body">
                                <ul>
                                    <li data-i18n="ui.component_editor.help.css.tip1">Use unique class names to avoid conflicts</li>
                                    <li data-i18n="ui.component_editor.help.css.tip2">Component CSS is injected inline with HTML</li>
                                    <li data-i18n="ui.component_editor.help.css.tip3" data-i18n-html="true">Consider using a prefix for your component classes (e.g., <code>.card-component-title</code>)</li>
                                </ul>
                            </div>
                        </div>

                        <div class="setting-card">
                            <div class="setting-card-header">
                                <i class="fas fa-book me-2"></i>
                                <span data-i18n="ui.component_editor.help.resources.title">Additional Resources</span>
                            </div>
                            <div class="setting-card-body">
                                <p><span data-i18n="ui.component_editor.help.resources.description">For full documentation, visit:</span> <a href="https://docs.keyq.cloud/web-components" target="_blank" style="color: #ff6b35;">https://docs.keyq.cloud/web-components</a></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer>
            <div class="footer-content d-flex justify-content-between align-items-center">
                <div class="d-flex gap-3">
                    <span>Kyte Shipyard™ Version <span id="kyteShipyardVersion">1.0.0</span></span>
                    <span>Kyte JS Version <span id="kyteJSVersion">2.0.0</span></span>
                </div>
                <span>KeyQ © 2020-2026</span>
            </div>
        </footer>
    </div>

    <!-- modal form -->
    <div id="modalForm"></div>

    <!-- Get Code Modal -->
    <div class="modal fade" id="getCodeModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content" style="background: #2d2d30; color: #d4d4d4; border: 1px solid #3e3e42;">
                <div class="modal-header" style="border-bottom: 1px solid #3e3e42;">
                    <h5 class="modal-title" style="color: #ffffff;">
                        <i class="fas fa-code me-2"></i>
                        <span data-i18n="ui.component_editor.modal.get_code.title">Component Usage Code</span>
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <ul class="nav nav-tabs mb-3" id="codeModalTabs" role="tablist" style="border-bottom: 1px solid #3e3e42;">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="loadingCode-tab" data-bs-toggle="tab" data-bs-target="#loadingCode" type="button" style="color: #d4d4d4;" data-i18n="ui.component_editor.modal.get_code.tab.loading">Loading Component</button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="usageCode-tab" data-bs-toggle="tab" data-bs-target="#usageCode" type="button" style="color: #d4d4d4;" data-i18n="ui.component_editor.modal.get_code.tab.usage">Usage Example</button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="sampleDataCode-tab" data-bs-toggle="tab" data-bs-target="#sampleDataCode" type="button" style="color: #d4d4d4;" data-i18n="ui.component_editor.modal.get_code.tab.sample_data">Sample Data</button>
                        </li>
                    </ul>
                    <div class="tab-content" id="codeModalTabContent">
                        <div class="tab-pane fade show active" id="loadingCode" role="tabpanel">
                            <pre style="background: #1e1e1e; padding: 1rem; border-radius: 4px; color: #d4d4d4; max-height: 400px; overflow-y: auto;"><code id="loadingCodeContent"></code></pre>
                            <button class="btn btn-sm btn-success mt-2" onclick="copyToClipboard('loadingCodeContent')">
                                <i class="fas fa-copy me-1"></i> <span data-i18n="ui.component_editor.modal.get_code.copy">Copy Code</span>
                            </button>
                        </div>
                        <div class="tab-pane fade" id="usageCode" role="tabpanel">
                            <pre style="background: #1e1e1e; padding: 1rem; border-radius: 4px; color: #d4d4d4; max-height: 400px; overflow-y: auto;"><code id="usageCodeContent"></code></pre>
                            <button class="btn btn-sm btn-success mt-2" onclick="copyToClipboard('usageCodeContent')">
                                <i class="fas fa-copy me-1"></i> <span data-i18n="ui.component_editor.modal.get_code.copy">Copy Code</span>
                            </button>
                        </div>
                        <div class="tab-pane fade" id="sampleDataCode" role="tabpanel">
                            <pre style="background: #1e1e1e; padding: 1rem; border-radius: 4px; color: #d4d4d4; max-height: 400px; overflow-y: auto;"><code id="sampleDataCodeContent"></code></pre>
                            <button class="btn btn-sm btn-success mt-2" onclick="copyToClipboard('sampleDataCodeContent')">
                                <i class="fas fa-copy me-1"></i> <span data-i18n="ui.component_editor.modal.get_code.copy">Copy Code</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Import Component Modal -->
    <div class="modal fade" id="importModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content" style="background: #2d2d30; color: #d4d4d4; border: 1px solid #3e3e42;">
                <div class="modal-header" style="border-bottom: 1px solid #3e3e42;">
                    <h5 class="modal-title" style="color: #ffffff;">
                        <i class="fas fa-upload me-2"></i>
                        <span data-i18n="ui.component_editor.modal.import.title">Import Component</span>
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p data-i18n="ui.component_editor.modal.import.description">Upload a JSON file exported from another component to import it.</p>
                    <input type="file" class="form-control" id="importFileInput" accept=".json" style="background: #3c3c3c; border: 1px solid #5a5a5a; color: #d4d4d4;">
                    <div class="mt-3" id="importPreview" style="display: none;">
                        <h6 data-i18n="ui.component_editor.modal.import.preview_title">Component Preview:</h6>
                        <ul id="importPreviewDetails" style="font-size: 0.9rem;"></ul>
                    </div>
                </div>
                <div class="modal-footer" style="border-top: 1px solid #3e3e42;">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" data-i18n="ui.component_editor.modal.import.cancel">Cancel</button>
                    <button type="button" class="btn btn-success" id="importConfirmBtn" disabled>
                        <i class="fas fa-check me-1"></i> <span data-i18n="ui.component_editor.modal.import.confirm">Import</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Component Templates Modal (for new components) -->
    <div class="modal fade" id="templatesModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content" style="background: #2d2d30; color: #d4d4d4; border: 1px solid #3e3e42;">
                <div class="modal-header" style="border-bottom: 1px solid #3e3e42;">
                    <h5 class="modal-title" style="color: #ffffff;">
                        <i class="fas fa-th-large me-2"></i>
                        <span data-i18n="ui.component_editor.modal.templates.title">Choose a Component Template</span>
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row g-3" id="templatesGrid">
                        <!-- Template cards will be dynamically inserted here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Initialize i18n for authenticated pages -->
    <script>
        document.addEventListener('KyteInitialized', async function(e) {
            // Get user's stored language preference
            const userLanguage = localStorage.getItem('kyte_user_language');

            const kyteI18n = new KyteI18n('en', '/assets/i18n/');

            // Initialize with user's preference (falls back to browser detection if null)
            await kyteI18n.init(userLanguage);

            // Make kyteI18n globally available
            window.kyteI18n = kyteI18n;

            // Translate all DOM elements with data-i18n attributes
            kyteI18n.translateDOM();

            // Manually update page title
            document.title = kyteI18n.t('ui.component_editor.page_title');
        });
    </script>

    <script>
        // Copy to clipboard helper function
        function copyToClipboard(elementId) {
            const element = document.getElementById(elementId);
            const text = element.textContent;
            const t = window.kyteI18n ? (key) => window.kyteI18n.t(key) : (key) => key;

            navigator.clipboard.writeText(text).then(() => {
                // Show success feedback
                const btn = event.target.closest('button');
                const originalHTML = btn.innerHTML;
                btn.innerHTML = '<i class="fas fa-check me-1"></i> ' + t('ui.component_editor.modal.get_code.copied');
                btn.classList.remove('btn-success');
                btn.classList.add('btn-info');

                setTimeout(() => {
                    btn.innerHTML = originalHTML;
                    btn.classList.remove('btn-info');
                    btn.classList.add('btn-success');
                }, 2000);
            }).catch(err => {
                console.error('Failed to copy:', err);
                alert(t('ui.component_editor.modal.get_code.copy_failed') || 'Failed to copy to clipboard');
            });
        }
    </script>
</body>
</html>